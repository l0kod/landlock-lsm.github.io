

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Message-based devices &mdash; The Linux Kernel  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="InfiniBand and Remote DMA (RDMA) Interfaces" href="infiniband.html" />
    <link rel="prev" title="Component Helper for Aggregate Drivers" href="component.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.10.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The Linux driver implementer’s API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="driver-model/index.html">Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html">Driver Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="infrastructure.html">Device drivers infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="ioctl.html">ioctl based interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="early-userspace/index.html">Early Userspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="pm/index.html">CPU and Device Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="clk.html">The Common Clk Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-io.html">Bus-Independent Device Accesses</a></li>
<li class="toctree-l2"><a class="reference internal" href="dma-buf.html">Buffer Sharing and Synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_link.html">Device links</a></li>
<li class="toctree-l2"><a class="reference internal" href="component.html">Component Helper for Aggregate Drivers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Message-based devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fusion-message-devices">Fusion message devices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="infiniband.html">InfiniBand and Remote DMA (RDMA) Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="frame-buffer.html">Frame Buffer Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator.html">Voltage and current regulator API</a></li>
<li class="toctree-l2"><a class="reference internal" href="iio/index.html">Industrial I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html">Input Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb/index.html">Linux USB API</a></li>
<li class="toctree-l2"><a class="reference internal" href="firewire.html">Firewire (IEEE 1394) driver Interface Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="pci/index.html">The Linux PCI driver implementer’s API guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="spi.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="i2c.html">I<sup>2</sup>C and SMBus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipmb.html">IPMB Driver for a Satellite MC</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipmi.html">The Linux IPMI Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="i3c/index.html">I3C subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="interconnect.html">Generic System Interconnect Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="devfreq.html">Device Frequency Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="hsi.html">High Speed Synchronous Serial Interface (HSI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="edac.html">Error Detection And Correction (EDAC) Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi.html">SCSI Interfaces Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="libata.html">libATA Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="target.html">target and iSCSI Interfaces Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailbox.html">The Common Mailbox Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtdnand.html">MTD NAND Driver Programming Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html">Parallel Port Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html#x50-uart-driver">16x50 UART Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html#pulse-width-modulation-pwm">Pulse-Width Modulation (PWM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mei/index.html">Intel(R) Management Engine Interface (Intel(R) MEI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtd/index.html">Memory Technology Device (MTD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmc/index.html">MMC/SD/SDIO card support</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvdimm/index.html">Non-Volatile Memory Device (NVDIMM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="w1.html">W1: Dallas’ 1-wire bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapidio/index.html">The Linux RapidIO Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="s390-drivers.html">Writing s390 channel device drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="vme.html">VME Device Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="80211/index.html">Linux 802.11 Driver Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="uio-howto.html">The Userspace I/O HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware/index.html">Linux Firmware API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pinctl.html">PINCTRL (PIN CONTROL) subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpio/index.html">General Purpose Input/Output (GPIO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="md/index.html">RAID</a></li>
<li class="toctree-l2"><a class="reference internal" href="media/index.html">Media subsystem kernel internal API</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc_devices.html">Miscellaneous Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="nfc/index.html">Near Field Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="dmaengine/index.html">DMAEngine documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="slimbus.html">Linux kernel SLIMbus support</a></li>
<li class="toctree-l2"><a class="reference internal" href="soundwire/index.html">SoundWire Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermal/index.html">Thermal</a></li>
<li class="toctree-l2"><a class="reference internal" href="fpga/index.html">FPGA Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="acpi/index.html">ACPI Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="backlight/lp855x-driver.html">Kernel driver lp855x</a></li>
<li class="toctree-l2"><a class="reference internal" href="connector.html">Kernel Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="console.html">Console Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcdbas.html">Dell Systems Management Base Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="eisa.html">EISA bus support</a></li>
<li class="toctree-l2"><a class="reference internal" href="isa.html">ISA Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="isapnp.html">ISA Plug &amp; Play support by Jaroslav Kysela &lt;perex&#64;suse.cz&gt;</a></li>
<li class="toctree-l2"><a class="reference internal" href="io-mapping.html">The io_mapping functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="io_ordering.html">Ordering I/O writes to memory-mapped addresses</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic-counter.html">Generic Counter Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="lightnvm-pblk.html">pblk: Physical Block Device Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory-devices/index.html">Memory Controller drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="men-chameleon-bus.html">MEN Chameleon Bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="ntb.html">NTB Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvmem.html">NVMEM Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="parport-lowlevel.html">PARPORT interface documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pps.html">PPS - Pulse Per Second</a></li>
<li class="toctree-l2"><a class="reference internal" href="ptp.html">PTP hardware clock infrastructure for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="phy/index.html">Generic PHY Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="pti_intel_mid.html">Intel MID PTI</a></li>
<li class="toctree-l2"><a class="reference internal" href="pwm.html">Pulse Width Modulation (PWM) interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="pldmfw/index.html">PLDM Firmware Flash Update Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="pldmfw/index.html#overview-of-the-pldmfw-library">Overview of the <code class="docutils literal notranslate"><span class="pre">pldmfw</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="rfkill.html">rfkill - RF kill switch support</a></li>
<li class="toctree-l2"><a class="reference internal" href="serial/index.html">Support for Serial devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="sm501.html">SM501 Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="switchtec.html">Linux Switchtec Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="sync_file.html">Sync File API Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="vfio-mediated-device.html">VFIO Mediated devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="vfio.html">VFIO - “Virtual Function I/O” </a></li>
<li class="toctree-l2"><a class="reference internal" href="xilinx/index.html">Xilinx FPGA</a></li>
<li class="toctree-l2"><a class="reference internal" href="xillybus.html">Xillybus driver for generic FPGA interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorro.html">Writing Device Drivers for Zorro Devices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">The Linux driver implementer’s API guide</a> &raquo;</li>
        
      <li>Message-based devices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/driver-api/message-based.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="message-based-devices">
<h1>Message-based devices<a class="headerlink" href="#message-based-devices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fusion-message-devices">
<h2>Fusion message devices<a class="headerlink" href="#fusion-message-devices" title="Permalink to this headline">¶</a></h2>
<dl class="c function">
<dt id="c.mpt_register">
u8 <code class="sig-name descname">mpt_register</code><span class="sig-paren">(</span>MPT_CALLBACK <em>cbfunc</em>, MPT_DRIVER_CLASS <em>dclass</em>, char *<em>func_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register protocol-specific main callback handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_CALLBACK</span> <span class="pre">cbfunc</span></code></dt><dd><p>callback function pointer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_DRIVER_CLASS</span> <span class="pre">dclass</span></code></dt><dd><p>Protocol driver’s class (<code class="docutils literal notranslate"><span class="pre">MPT_DRIVER_CLASS</span></code> enum value)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*func_name</span></code></dt><dd><p>call function’s name</p>
<p>This routine is called by a protocol-specific driver (SCSI host,
LAN, SCSI target) to register its reply callback routine.  Each
protocol-specific driver must do this before it will be able to
use any IOC resources, such as obtaining request frames.</p>
</dd>
</dl>
<p><strong>NOTES</strong></p>
<dl>
<dt>The SCSI protocol driver currently calls this routine thrice</dt><dd><p>in order to register separate callbacks; one for “normal” SCSI IO;
one for MptScsiTaskMgmt requests; one for Scan/DV requests.</p>
<p>Returns u8 valued “handle” in the range (and S.O.D. order)
{N,…,7,6,5,…,1} if successful.
A return value of MPT_MAX_PROTOCOL_DRIVERS (including zero!) should be
considered an error by the caller.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_deregister">
void <code class="sig-name descname">mpt_deregister</code><span class="sig-paren">(</span>u8 <em>cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_deregister" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Deregister a protocol drivers resources.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered callback handle</p>
<p>Each protocol-specific driver should call this routine when its
module is unloaded.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_event_register">
int <code class="sig-name descname">mpt_event_register</code><span class="sig-paren">(</span>u8 <em>cb_idx</em>, MPT_EVHANDLER <em>ev_cbfunc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_event_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register protocol-specific event callback handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered (via mpt_register) callback handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_EVHANDLER</span> <span class="pre">ev_cbfunc</span></code></dt><dd><p>callback function</p>
<p>This routine can be called by one or more protocol-specific drivers
if/when they choose to be notified of MPT events.</p>
<p>Returns 0 for success.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_event_deregister">
void <code class="sig-name descname">mpt_event_deregister</code><span class="sig-paren">(</span>u8 <em>cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_event_deregister" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Deregister protocol-specific event callback handler</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered callback handle</p>
<p>Each protocol-specific driver should call this routine
when it does not (or can no longer) handle events,
or when its module is unloaded.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_reset_register">
int <code class="sig-name descname">mpt_reset_register</code><span class="sig-paren">(</span>u8 <em>cb_idx</em>, MPT_RESETHANDLER <em>reset_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_reset_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register protocol-specific IOC reset handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered (via mpt_register) callback handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_RESETHANDLER</span> <span class="pre">reset_func</span></code></dt><dd><p>reset function</p>
<p>This routine can be called by one or more protocol-specific drivers
if/when they choose to be notified of IOC resets.</p>
<p>Returns 0 for success.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_reset_deregister">
void <code class="sig-name descname">mpt_reset_deregister</code><span class="sig-paren">(</span>u8 <em>cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_reset_deregister" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Deregister protocol-specific IOC reset handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered callback handle</p>
<p>Each protocol-specific driver should call this routine
when it does not (or can no longer) handle IOC reset handling,
or when its module is unloaded.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_device_driver_register">
int <code class="sig-name descname">mpt_device_driver_register</code><span class="sig-paren">(</span><em class="property">struct</em> mpt_pci_driver *<em>dd_cbfunc</em>, u8 <em>cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_device_driver_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register device driver hooks</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">mpt_pci_driver</span> <span class="pre">*</span> <span class="pre">dd_cbfunc</span></code></dt><dd><p>driver callbacks struct</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>MPT protocol driver index</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_device_driver_deregister">
void <code class="sig-name descname">mpt_device_driver_deregister</code><span class="sig-paren">(</span>u8 <em>cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_device_driver_deregister" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>DeRegister device driver hooks</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>MPT protocol driver index</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_get_msg_frame">
MPT_FRAME_HDR *<code class="sig-name descname">mpt_get_msg_frame</code><span class="sig-paren">(</span>u8 <em>cb_idx</em>, MPT_ADAPTER *<em>ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_get_msg_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Obtain an MPT request frame from the pool</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
<p>Obtain an MPT request frame from the pool (of 1024) that are
allocated per MPT adapter.</p>
<p>Returns pointer to a MPT request frame or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if none are available
or IOC is not active.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_put_msg_frame">
void <code class="sig-name descname">mpt_put_msg_frame</code><span class="sig-paren">(</span>u8 <em>cb_idx</em>, MPT_ADAPTER *<em>ioc</em>, MPT_FRAME_HDR *<em>mf</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_put_msg_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Send a protocol-specific MPT request frame to an IOC</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to MPT request frame</p>
<p>This routine posts an MPT request frame to the request post FIFO of a
specific MPT adapter.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_put_msg_frame_hi_pri">
void <code class="sig-name descname">mpt_put_msg_frame_hi_pri</code><span class="sig-paren">(</span>u8 <em>cb_idx</em>, MPT_ADAPTER *<em>ioc</em>, MPT_FRAME_HDR *<em>mf</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_put_msg_frame_hi_pri" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Send a hi-pri protocol-specific MPT request frame</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to MPT request frame</p>
<p>Send a protocol-specific MPT request frame to an IOC using
hi-priority request queue.</p>
<p>This routine posts an MPT request frame to the request post FIFO of a
specific MPT adapter.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_free_msg_frame">
void <code class="sig-name descname">mpt_free_msg_frame</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, MPT_FRAME_HDR *<em>mf</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_free_msg_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Place MPT request frame back on FreeQ.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to MPT request frame</p>
<p>This routine places a MPT request frame back on the MPT adapter’s
FreeQ.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_send_handshake_request">
int <code class="sig-name descname">mpt_send_handshake_request</code><span class="sig-paren">(</span>u8 <em>cb_idx</em>, MPT_ADAPTER *<em>ioc</em>, int <em>reqBytes</em>, u32 *<em>req</em>, int <em>sleepFlag</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_send_handshake_request" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Send MPT request via doorbell handshake method.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">reqBytes</span></code></dt><dd><p>Size of the request in bytes</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*req</span></code></dt><dd><p>Pointer to MPT request frame</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt><dd><p>Use schedule if CAN_SLEEP else use udelay.</p>
<p>This routine is used exclusively to send MptScsiTaskMgmt
requests since they are required to be sent via doorbell handshake.</p>
</dd>
</dl>
<p><strong>NOTE</strong></p>
<dl>
<dt>It is the callers responsibility to byte-swap fields in the</dt><dd><p>request which are greater than 1 byte in size.</p>
<p>Returns 0 for success, non-zero for failure.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_verify_adapter">
int <code class="sig-name descname">mpt_verify_adapter</code><span class="sig-paren">(</span>int <em>iocid</em>, MPT_ADAPTER **<em>iocpp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_verify_adapter" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Given IOC identifier, set pointer to its adapter structure.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">iocid</span></code></dt><dd><p>IOC unique identifier (integer)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">**iocpp</span></code></dt><dd><p>Pointer to pointer to IOC adapter</p>
<p>Given a unique IOC identifier, set pointer to the associated MPT
adapter structure.</p>
<p>Returns iocid and sets iocpp if iocid is found.
Returns -1 if iocid is not found.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_attach">
int <code class="sig-name descname">mpt_attach</code><span class="sig-paren">(</span><em class="property">struct</em> pci_dev *<em>pdev</em>, <em class="property">const</em> <em class="property">struct</em> <a class="reference internal" href="../PCI/pci.html#c.pci_device_id" title="pci_device_id">pci_device_id</a> *<em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_attach" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Install a PCI intelligent MPT adapter.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">pci_device_id</span> <span class="pre">*id</span></code></dt><dd><p>PCI device ID information</p>
<p>This routine performs all the steps necessary to bring the IOC of
a MPT adapter to a OPERATIONAL state.  This includes registering
memory regions, registering the interrupt, and allocating request
and reply memory pools.</p>
<p>This routine also pre-fetches the LAN MAC address of a Fibre Channel
MPT adapter.</p>
<p>Returns 0 for success, non-zero for failure.</p>
<p>TODO: Add support for polled controllers</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_detach">
void <code class="sig-name descname">mpt_detach</code><span class="sig-paren">(</span><em class="property">struct</em> pci_dev *<em>pdev</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_detach" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Remove a PCI intelligent MPT adapter.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_suspend">
int <code class="sig-name descname">mpt_suspend</code><span class="sig-paren">(</span><em class="property">struct</em> pci_dev *<em>pdev</em>, pm_message_t <em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_suspend" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fusion MPT base driver suspend routine.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pm_message_t</span> <span class="pre">state</span></code></dt><dd><p>new state to enter</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_resume">
int <code class="sig-name descname">mpt_resume</code><span class="sig-paren">(</span><em class="property">struct</em> pci_dev *<em>pdev</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_resume" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fusion MPT base driver resume routine.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_GetIocState">
u32 <code class="sig-name descname">mpt_GetIocState</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, int <em>cooked</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_GetIocState" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the current state of a MPT adapter.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">cooked</span></code></dt><dd><p>Request raw or cooked IOC state</p>
<p>Returns all IOC Doorbell register bits if cooked==0, else just the
Doorbell bits in MPI_IOC_STATE_MASK.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_alloc_fw_memory">
int <code class="sig-name descname">mpt_alloc_fw_memory</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, int <em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_alloc_fw_memory" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>allocate firmware memory</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">size</span></code></dt><dd><p>total FW bytes</p>
<p>If memory has already been allocated, the same (cached) value
is returned.</p>
<p>Return 0 if successful, or non-zero for failure</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_free_fw_memory">
void <code class="sig-name descname">mpt_free_fw_memory</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_free_fw_memory" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>free firmware memory</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
<p>If alt_img is NULL, delete from ioc structure.
Else, delete a secondary image in same format.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptbase_sas_persist_operation">
int <code class="sig-name descname">mptbase_sas_persist_operation</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, u8 <em>persist_opcode</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptbase_sas_persist_operation" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform operation on SAS Persistent Table</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">persist_opcode</span></code></dt><dd><p>see below</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>MPI_SAS_OP_CLEAR_NOT_PRESENT</p></td>
<td><p>Free all persist TargetID mappings for
devices not currently present.</p></td>
</tr>
<tr class="row-even"><td><p>MPI_SAS_OP_CLEAR_ALL_PERSISTENT</p></td>
<td><p>Clear al persist TargetID mappings</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p><strong>NOTE</strong></p>
<p>Don’t use not this function during interrupt time.</p>
<blockquote>
<div><p>Returns 0 for success, non-zero error</p>
</div></blockquote>
<dl class="c function">
<dt id="c.mpt_raid_phys_disk_pg0">
int <code class="sig-name descname">mpt_raid_phys_disk_pg0</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, u8 <em>phys_disk_num</em>, RaidPhysDiskPage0_t *<em>phys_disk</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_pg0" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>returns phys disk page zero</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt><dd><p>io unit unique phys disk num generated by the ioc</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RaidPhysDiskPage0_t</span> <span class="pre">*phys_disk</span></code></dt><dd><p>requested payload data returned</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</p>
</div></blockquote>
<dl class="c function">
<dt id="c.mpt_raid_phys_disk_get_num_paths">
int <code class="sig-name descname">mpt_raid_phys_disk_get_num_paths</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, u8 <em>phys_disk_num</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_get_num_paths" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>returns number paths associated to this phys_num</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt><dd><p>io unit unique phys disk num generated by the ioc</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>returns number paths</p>
</div></blockquote>
<dl class="c function">
<dt id="c.mpt_raid_phys_disk_pg1">
int <code class="sig-name descname">mpt_raid_phys_disk_pg1</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, u8 <em>phys_disk_num</em>, RaidPhysDiskPage1_t *<em>phys_disk</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_pg1" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>returns phys disk page 1</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt><dd><p>io unit unique phys disk num generated by the ioc</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RaidPhysDiskPage1_t</span> <span class="pre">*phys_disk</span></code></dt><dd><p>requested payload data returned</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</p>
</div></blockquote>
<dl class="c function">
<dt id="c.mpt_findImVolumes">
int <code class="sig-name descname">mpt_findImVolumes</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_findImVolumes" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Identify IDs of hidden disks and RAID Volumes</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Strucutre</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</p>
</div></blockquote>
<dl class="c function">
<dt id="c.mpt_config">
int <code class="sig-name descname">mpt_config</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, CONFIGPARMS *<em>pCfg</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_config" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generic function to issue config message</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to an adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CONFIGPARMS</span> <span class="pre">*pCfg</span></code></dt><dd><p>Pointer to a configuration structure. Struct contains
action, page address, direction, physical address
and pointer to a configuration page header
Page header is updated.</p>
<blockquote>
<div><p>Returns 0 for success
-EPERM if not allowed due to ISR context
-EAGAIN if no msg frames currently available
-EFAULT for non-successful reply or no reply (timeout)</p>
</div></blockquote>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_print_ioc_summary">
void <code class="sig-name descname">mpt_print_ioc_summary</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, char *<em>buffer</em>, int *<em>size</em>, int <em>len</em>, int <em>showlan</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_print_ioc_summary" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Write ASCII summary of IOC to a buffer.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buffer</span></code></dt><dd><p>Pointer to buffer where IOC summary info should be written</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">*size</span></code></dt><dd><p>Pointer to number of bytes we wrote (set by this routine)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">len</span></code></dt><dd><p>Offset at which to start writing in buffer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">showlan</span></code></dt><dd><p>Display LAN stuff?</p>
<p>This routine writes (english readable) ASCII text, which represents
a summary of IOC information, to a buffer.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_set_taskmgmt_in_progress_flag">
int <code class="sig-name descname">mpt_set_taskmgmt_in_progress_flag</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_set_taskmgmt_in_progress_flag" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>set flags associated with task management</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
<p>Returns 0 for SUCCESS or -1 if FAILED.</p>
<p>If -1 is return, then it was not possible to set the flags</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_clear_taskmgmt_in_progress_flag">
void <code class="sig-name descname">mpt_clear_taskmgmt_in_progress_flag</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_clear_taskmgmt_in_progress_flag" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>clear flags associated with task management</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_halt_firmware">
void <code class="sig-name descname">mpt_halt_firmware</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_halt_firmware" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Halts the firmware if it is operational and panic the kernel</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_Soft_Hard_ResetHandler">
int <code class="sig-name descname">mpt_Soft_Hard_ResetHandler</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, int <em>sleepFlag</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_Soft_Hard_ResetHandler" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Try less expensive reset</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt><dd><p>Indicates if sleep or schedule must be called.</p>
<p>Returns 0 for SUCCESS or -1 if FAILED.
Try for softreset first, only if it fails go for expensive
HardReset.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mpt_HardResetHandler">
int <code class="sig-name descname">mpt_HardResetHandler</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, int <em>sleepFlag</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_HardResetHandler" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generic reset handler</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt><dd><p>Indicates if sleep or schedule must be called.</p>
<p>Issues SCSI Task Management call based on input arg values.
If TaskMgmt fails, returns associated SCSI request.</p>
<p>Remark: _HardResetHandler can be invoked from an interrupt thread (timer)
or a non-interrupt thread.  In the former, must not call schedule().</p>
</dd>
</dl>
<p><strong>Note</strong></p>
<dl>
<dt>A return of -1 is a FATAL error case, as it means a</dt><dd><p>FW reload/initialization failed.</p>
<p>Returns 0 for SUCCESS or -1 if FAILED.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_info">
<em class="property">const</em> char *<code class="sig-name descname">mptscsih_info</code><span class="sig-paren">(</span><em class="property">struct</em> Scsi_Host *<em>SChost</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return information about MPT adapter</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">Scsi_Host</span> <span class="pre">*SChost</span></code></dt><dd><p>Pointer to Scsi_Host structure</p>
<p>(linux scsi_host_template.info routine)</p>
<p>Returns pointer to buffer where information was written.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_qcmd">
int <code class="sig-name descname">mptscsih_qcmd</code><span class="sig-paren">(</span><em class="property">struct</em> scsi_cmnd *<em>SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_qcmd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Primary Fusion MPT SCSI initiator IO start routine.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure</p>
<p>(linux scsi_host_template.queuecommand routine)
This is the primary SCSI IO start routine.  Create a MPI SCSIIORequest
from a linux scsi_cmnd request and send it to the IOC.</p>
<p>Returns 0. (rtn value discarded by linux scsi mid-layer)</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_IssueTaskMgmt">
int <code class="sig-name descname">mptscsih_IssueTaskMgmt</code><span class="sig-paren">(</span>MPT_SCSI_HOST *<em>hd</em>, u8 <em>type</em>, u8 <em>channel</em>, u8 <em>id</em>, u64 <em>lun</em>, int <em>ctx2abort</em>, ulong <em>timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_IssueTaskMgmt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generic send Task Management function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_SCSI_HOST</span> <span class="pre">*hd</span></code></dt><dd><p>Pointer to MPT_SCSI_HOST structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">type</span></code></dt><dd><p>Task Management type</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">channel</span></code></dt><dd><p>channel number for task management</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">id</span></code></dt><dd><p>Logical Target ID for reset (if appropriate)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u64</span> <span class="pre">lun</span></code></dt><dd><p>Logical Unit for reset (if appropriate)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">ctx2abort</span></code></dt><dd><p>Context for the task to be aborted (if appropriate)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ulong</span> <span class="pre">timeout</span></code></dt><dd><p>timeout for task management control</p>
<p>Remark: _HardResetHandler can be invoked from an interrupt thread (timer)
or a non-interrupt thread.  In the former, must not call schedule().</p>
<p>Not all fields are meaningfull for all task types.</p>
<p>Returns 0 for SUCCESS, or FAILED.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_abort">
int <code class="sig-name descname">mptscsih_abort</code><span class="sig-paren">(</span><em class="property">struct</em> scsi_cmnd *<em>SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_abort" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Abort linux scsi_cmnd routine, new_eh variant</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO to be aborted</p>
<p>(linux scsi_host_template.eh_abort_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_dev_reset">
int <code class="sig-name descname">mptscsih_dev_reset</code><span class="sig-paren">(</span><em class="property">struct</em> scsi_cmnd *<em>SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_dev_reset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI TARGET_RESET! new_eh variant</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_dev_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_bus_reset">
int <code class="sig-name descname">mptscsih_bus_reset</code><span class="sig-paren">(</span><em class="property">struct</em> scsi_cmnd *<em>SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_bus_reset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI BUS_RESET! new_eh variant</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_bus_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_host_reset">
int <code class="sig-name descname">mptscsih_host_reset</code><span class="sig-paren">(</span><em class="property">struct</em> scsi_cmnd *<em>SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_host_reset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI host adapter RESET (new_eh variant)</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_host_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_taskmgmt_complete">
int <code class="sig-name descname">mptscsih_taskmgmt_complete</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, MPT_FRAME_HDR *<em>mf</em>, MPT_FRAME_HDR *<em>mr</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_taskmgmt_complete" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Registered with Fusion MPT base driver</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to SCSI task mgmt request frame</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mr</span></code></dt><dd><p>Pointer to SCSI task mgmt reply frame</p>
<p>This routine is called from mptbase.c::mpt_interrupt() at the completion
of any SCSI task management request.
This routine is registered with the MPT (base) driver at driver
load/init time via the <a class="reference internal" href="#c.mpt_register" title="mpt_register"><code class="xref c c-func docutils literal notranslate"><span class="pre">mpt_register()</span></code></a> API call.</p>
<p>Returns 1 indicating alloc’d request frame ptr should be freed.</p>
</dd>
</dl>
<dl class="c function">
<dt id="c.mptscsih_get_scsi_lookup">
<em class="property">struct</em> scsi_cmnd *<code class="sig-name descname">mptscsih_get_scsi_lookup</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>ioc</em>, int <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_get_scsi_lookup" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>retrieves scmd entry</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">i</span></code></dt><dd><p>index into the array</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Returns the scsi_cmd pointer</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="infiniband.html" class="btn btn-neutral float-right" title="InfiniBand and Remote DMA (RDMA) Interfaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="component.html" class="btn btn-neutral float-left" title="Component Helper for Aggregate Drivers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright The kernel development community

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>