

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Contents of inode.i_block &mdash; The Linux Kernel 5.8.0-rc4+ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.8.0-rc4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>The Contents of inode.i_block</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/filesystems/ext4/ifork.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-contents-of-inode-i-block">
<h1>The Contents of inode.i_block<a class="headerlink" href="#the-contents-of-inode-i-block" title="Permalink to this headline">¶</a></h1>
<p>Depending on the type of file an inode describes, the 60 bytes of
storage in <code class="docutils literal notranslate"><span class="pre">inode.i_block</span></code> can be used in different ways. In general,
regular files and directories will use it for file block indexing
information, and special files will use it for special purposes.</p>
<div class="section" id="symbolic-links">
<h2>Symbolic Links<a class="headerlink" href="#symbolic-links" title="Permalink to this headline">¶</a></h2>
<p>The target of a symbolic link will be stored in this field if the target
string is less than 60 bytes long. Otherwise, either extents or block
maps will be used to allocate data blocks to store the link target.</p>
</div>
<div class="section" id="direct-indirect-block-addressing">
<h2>Direct/Indirect Block Addressing<a class="headerlink" href="#direct-indirect-block-addressing" title="Permalink to this headline">¶</a></h2>
<p>In ext2/3, file block numbers were mapped to logical block numbers by
means of an (up to) three level 1-1 block map. To find the logical block
that stores a particular file block, the code would navigate through
this increasingly complicated structure. Notice that there is neither a
magic number nor a checksum to provide any level of confidence that the
block isn’t full of garbage.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>i.i_block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to 11</p></td>
<td><p>Direct map to file blocks 0 to 11.</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Indirect block: (file blocks 12 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) + 11, or 12 to 1035 if 4KiB blocks)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Indirect Block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4)</p></td>
<td><p>Direct map to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) blocks (1024 if 4KiB blocks)</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>Double-indirect block: (file blocks <code class="docutils literal notranslate"><span class="pre">$block_size</span></code>/4 + 12 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) ^ 2 + (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) + 11, or 1036 to 1049611 if 4KiB blocks)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Double Indirect Block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4)</p></td>
<td><p>Map to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) indirect blocks (1024 if 4KiB blocks)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Indirect Block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4)</p></td>
<td><p>Direct map to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) blocks (1024 if 4KiB blocks)</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Triple-indirect block: (file blocks (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) ^ 2 + (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) + 12 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) ^ 3 + (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) ^ 2 + (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) + 12, or 1049612 to 1074791436 if 4KiB blocks)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Triple Indirect Block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4)</p></td>
<td><p>Map to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) double indirect blocks (1024 if 4KiB blocks)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Double Indirect Block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4)</p></td>
<td><p>Map to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) indirect blocks (1024 if 4KiB blocks)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Indirect Block Offset</p></th>
<th class="head"><p>Where It Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4)</p></td>
<td><p>Direct map to (<code class="docutils literal notranslate"><span class="pre">$block_size</span></code> / 4) blocks (1024 if 4KiB blocks)</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Note that with this block mapping scheme, it is necessary to fill out a
lot of mapping data even for a large contiguous file! This inefficiency
led to the creation of the extent mapping scheme, discussed below.</p>
<p>Notice also that a file using this mapping scheme cannot be placed
higher than 2^32 blocks.</p>
</div>
<div class="section" id="extent-tree">
<h2>Extent Tree<a class="headerlink" href="#extent-tree" title="Permalink to this headline">¶</a></h2>
<p>In ext4, the file to logical block map has been replaced with an extent
tree. Under the old scheme, allocating a contiguous run of 1,000 blocks
requires an indirect block to map all 1,000 entries; with extents, the
mapping is reduced to a single <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent</span></code> with
<code class="docutils literal notranslate"><span class="pre">ee_len</span> <span class="pre">=</span> <span class="pre">1000</span></code>. If flex_bg is enabled, it is possible to allocate
very large files with a single extent, at a considerable reduction in
metadata block use, and some improvement in disk efficiency. The inode
must have the extents flag (0x80000) flag set for this feature to be in
use.</p>
<p>Extents are arranged as a tree. Each node of the tree begins with a
<code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent_header</span></code>. If the node is an interior node
(<code class="docutils literal notranslate"><span class="pre">eh.eh_depth</span></code> &gt; 0), the header is followed by <code class="docutils literal notranslate"><span class="pre">eh.eh_entries</span></code>
instances of <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent_idx</span></code>; each of these index entries
points to a block containing more nodes in the extent tree. If the node
is a leaf node (<code class="docutils literal notranslate"><span class="pre">eh.eh_depth</span> <span class="pre">==</span> <span class="pre">0</span></code>), then the header is followed by
<code class="docutils literal notranslate"><span class="pre">eh.eh_entries</span></code> instances of <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent</span></code>; these instances
point to the file’s data blocks. The root node of the extent tree is
stored in <code class="docutils literal notranslate"><span class="pre">inode.i_block</span></code>, which allows for the first four extents to
be recorded without the use of extra metadata blocks.</p>
<p>The extent tree header is recorded in <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent_header</span></code>,
which is 12 bytes long:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>__le16</p></td>
<td><p>eh_magic</p></td>
<td><p>Magic number, 0xF30A.</p></td>
</tr>
<tr class="row-odd"><td><p>0x2</p></td>
<td><p>__le16</p></td>
<td><p>eh_entries</p></td>
<td><p>Number of valid entries following the header.</p></td>
</tr>
<tr class="row-even"><td><p>0x4</p></td>
<td><p>__le16</p></td>
<td><p>eh_max</p></td>
<td><p>Maximum number of entries that could follow the header.</p></td>
</tr>
<tr class="row-odd"><td><p>0x6</p></td>
<td><p>__le16</p></td>
<td><p>eh_depth</p></td>
<td><p>Depth of this extent node in the extent tree. 0 = this extent node
points to data blocks; otherwise, this extent node points to other
extent nodes. The extent tree can be at most 5 levels deep: a logical
block number can be at most <code class="docutils literal notranslate"><span class="pre">2^32</span></code>, and the smallest <code class="docutils literal notranslate"><span class="pre">n</span></code> that
satisfies <code class="docutils literal notranslate"><span class="pre">4*(((blocksize</span> <span class="pre">-</span> <span class="pre">12)/12)^n)</span> <span class="pre">&gt;=</span> <span class="pre">2^32</span></code> is 5.</p></td>
</tr>
<tr class="row-even"><td><p>0x8</p></td>
<td><p>__le32</p></td>
<td><p>eh_generation</p></td>
<td><p>Generation of the tree. (Used by Lustre, but not standard ext4).</p></td>
</tr>
</tbody>
</table>
<p>Internal nodes of the extent tree, also known as index nodes, are
recorded as <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent_idx</span></code>, and are 12 bytes long:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>__le32</p></td>
<td><p>ei_block</p></td>
<td><p>This index node covers file blocks from ‘block’ onward.</p></td>
</tr>
<tr class="row-odd"><td><p>0x4</p></td>
<td><p>__le32</p></td>
<td><p>ei_leaf_lo</p></td>
<td><p>Lower 32-bits of the block number of the extent node that is the next
level lower in the tree. The tree node pointed to can be either another
internal node or a leaf node, described below.</p></td>
</tr>
<tr class="row-even"><td><p>0x8</p></td>
<td><p>__le16</p></td>
<td><p>ei_leaf_hi</p></td>
<td><p>Upper 16-bits of the previous field.</p></td>
</tr>
<tr class="row-odd"><td><p>0xA</p></td>
<td><p>__u16</p></td>
<td><p>ei_unused</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Leaf nodes of the extent tree are recorded as <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent</span></code>,
and are also 12 bytes long:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>__le32</p></td>
<td><p>ee_block</p></td>
<td><p>First file block number that this extent covers.</p></td>
</tr>
<tr class="row-odd"><td><p>0x4</p></td>
<td><p>__le16</p></td>
<td><p>ee_len</p></td>
<td><p>Number of blocks covered by extent. If the value of this field is &lt;=
32768, the extent is initialized. If the value of the field is &gt; 32768,
the extent is uninitialized and the actual extent length is <code class="docutils literal notranslate"><span class="pre">ee_len</span></code> -
32768. Therefore, the maximum length of a initialized extent is 32768
blocks, and the maximum length of an uninitialized extent is 32767.</p></td>
</tr>
<tr class="row-even"><td><p>0x6</p></td>
<td><p>__le16</p></td>
<td><p>ee_start_hi</p></td>
<td><p>Upper 16-bits of the block number to which this extent points.</p></td>
</tr>
<tr class="row-odd"><td><p>0x8</p></td>
<td><p>__le32</p></td>
<td><p>ee_start_lo</p></td>
<td><p>Lower 32-bits of the block number to which this extent points.</p></td>
</tr>
</tbody>
</table>
<p>Prior to the introduction of metadata checksums, the extent header +
extent entries always left at least 4 bytes of unallocated space at the
end of each extent tree data block (because (2^x % 12) &gt;= 4). Therefore,
the 32-bit checksum is inserted into this space. The 4 extents in the
inode do not need checksumming, since the inode is already checksummed.
The checksum is calculated against the FS UUID, the inode number, the
inode generation, and the entire extent block leading up to (but not
including) the checksum itself.</p>
<p><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">ext4_extent_tail</span></code> is 4 bytes long:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>__le32</p></td>
<td><p>eb_checksum</p></td>
<td><p>Checksum of the extent block, crc32c(uuid+inum+igeneration+extentblock)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="inline-data">
<h2>Inline Data<a class="headerlink" href="#inline-data" title="Permalink to this headline">¶</a></h2>
<p>If the inline data feature is enabled for the filesystem and the flag is
set for the inode, it is possible that the first 60 bytes of the file
data are stored here.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>