

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NXP SJA1105 switch driver &mdash; The Linux Kernel 5.2.0-rc5+ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Devlink info versions" href="../devlink-info-versions.html" />
    <link rel="prev" title="LAN9303 Ethernet switch driver" href="lan9303.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.2.0-rc5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Linux Networking Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../netdev-FAQ.html">netdev FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../af_xdp.html">AF_XDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../batman-adv.html">batman-adv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../can.html">SocketCAN - Controller Area Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../can_ucan_protocol.html">The UCAN Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../device_drivers/index.html">Vendor Device Drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Distributed Switch Architecture</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dsa.html">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="bcm_sf2.html">Broadcom Starfighter 2 Ethernet switch driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="lan9303.html">LAN9303 Ethernet switch driver</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">NXP SJA1105 switch driver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#traffic-support">Traffic support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switching-features">Switching features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-tree-bindings-and-board-design">Device Tree bindings and board design</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../devlink-info-versions.html">Devlink info versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ieee802154.html">IEEE 802.15.4 Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kapi.html">Linux Networking and Network Devices APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../z8530book.html">Z8530 Programming Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../msg_zerocopy.html">MSG_ZEROCOPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../failover.html">FAILOVER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net_failover.html">NET_FAILOVER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phy.html">PHY Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sfp-phylink.html">phylink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alias.html">IP-Aliasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bridge.html">Ethernet Bridging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snmp_counter.html">SNMP counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../checksum-offloads.html">Checksum Offloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation-offloads.html">Segmentation Offloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scaling.html">Scaling in the Linux Networking Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tls.html">Kernel TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tls-offload.html">Kernel TLS offload</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Linux Networking Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Distributed Switch Architecture</a> &raquo;</li>
        
      <li>NXP SJA1105 switch driver</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/networking/dsa/sja1105.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nxp-sja1105-switch-driver">
<h1>NXP SJA1105 switch driver<a class="headerlink" href="#nxp-sja1105-switch-driver" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The NXP SJA1105 is a family of 6 devices:</p>
<ul class="simple">
<li>SJA1105E: First generation, no TTEthernet</li>
<li>SJA1105T: First generation, TTEthernet</li>
<li>SJA1105P: Second generation, no TTEthernet, no SGMII</li>
<li>SJA1105Q: Second generation, TTEthernet, no SGMII</li>
<li>SJA1105R: Second generation, no TTEthernet, SGMII</li>
<li>SJA1105S: Second generation, TTEthernet, SGMII</li>
</ul>
<p>These are SPI-managed automotive switches, with all ports being gigabit
capable, and supporting MII/RMII/RGMII and optionally SGMII on one port.</p>
<p>Being automotive parts, their configuration interface is geared towards
set-and-forget use, with minimal dynamic interaction at runtime. They
require a static configuration to be composed by software and packed
with CRC and table headers, and sent over SPI.</p>
<p>The static configuration is composed of several configuration tables. Each
table takes a number of entries. Some configuration tables can be (partially)
reconfigured at runtime, some not. Some tables are mandatory, some not:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="24%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Table</th>
<th class="head">Mandatory</th>
<th class="head">Reconfigurable</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Schedule</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>Schedule entry points</td>
<td>if Scheduling</td>
<td>no</td>
</tr>
<tr class="row-even"><td>VL Lookup</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>VL Policing</td>
<td>if VL Lookup</td>
<td>no</td>
</tr>
<tr class="row-even"><td>VL Forwarding</td>
<td>if VL Lookup</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>L2 Lookup</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-even"><td>L2 Policing</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>VLAN Lookup</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>L2 Forwarding</td>
<td>yes</td>
<td>partially (fully on P/Q/R/S)</td>
</tr>
<tr class="row-odd"><td>MAC Config</td>
<td>yes</td>
<td>partially (fully on P/Q/R/S)</td>
</tr>
<tr class="row-even"><td>Schedule Params</td>
<td>if Scheduling</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>Schedule Entry Points Params</td>
<td>if Scheduling</td>
<td>no</td>
</tr>
<tr class="row-even"><td>VL Forwarding Params</td>
<td>if VL Forwarding</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>L2 Lookup Params</td>
<td>no</td>
<td>partially (fully on P/Q/R/S)</td>
</tr>
<tr class="row-even"><td>L2 Forwarding Params</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>Clock Sync Params</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-even"><td>AVB Params</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>General Params</td>
<td>yes</td>
<td>partially</td>
</tr>
<tr class="row-even"><td>Retagging</td>
<td>no</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>xMII Params</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-even"><td>SGMII</td>
<td>no</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>Also the configuration is write-only (software cannot read it back from the
switch except for very few exceptions).</p>
<p>The driver creates a static configuration at probe time, and keeps it at
all times in memory, as a shadow for the hardware state. When required to
change a hardware setting, the static configuration is also updated.
If that changed setting can be transmitted to the switch through the dynamic
reconfiguration interface, it is; otherwise the switch is reset and
reprogrammed with the updated static configuration.</p>
</div>
<div class="section" id="traffic-support">
<h2>Traffic support<a class="headerlink" href="#traffic-support" title="Permalink to this headline">¶</a></h2>
<p>The switches do not support switch tagging in hardware. But they do support
customizing the TPID by which VLAN traffic is identified as such. The switch
driver is leveraging <code class="docutils literal notranslate"><span class="pre">CONFIG_NET_DSA_TAG_8021Q</span></code> by requesting that special
VLANs (with a custom TPID of <code class="docutils literal notranslate"><span class="pre">ETH_P_EDSA</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ETH_P_8021Q</span></code>) are
installed on its ports when not in <code class="docutils literal notranslate"><span class="pre">vlan_filtering</span></code> mode. This does not
interfere with the reception and transmission of real 802.1Q-tagged traffic,
because the switch does no longer parse those packets as VLAN after the TPID
change.
The TPID is restored when <code class="docutils literal notranslate"><span class="pre">vlan_filtering</span></code> is requested by the user through
the bridge layer, and general IP termination becomes no longer possible through
the switch netdevices in this mode.</p>
<p>The switches have two programmable filters for link-local destination MACs.
These are used to trap BPDUs and PTP traffic to the master netdevice, and are
further used to support STP and 1588 ordinary clock/boundary clock
functionality.</p>
<p>The following traffic modes are supported over the switch netdevices:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="18%" />
<col width="26%" />
<col width="26%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head"><dl class="first last docutils">
<dt>Standalone</dt>
<dd>ports</dd>
</dl>
</th>
<th class="head"><blockquote class="first">
<div>Bridged with</div></blockquote>
<p class="last">vlan_filtering 0</p>
</th>
<th class="head"><blockquote class="first">
<div>Bridged with</div></blockquote>
<p class="last">vlan_filtering 1</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Regular traffic</td>
<td>Yes</td>
<td>Yes</td>
<td>No (use master)</td>
</tr>
<tr class="row-odd"><td><dl class="first last docutils">
<dt>Management traffic</dt>
<dd>(BPDU, PTP)</dd>
</dl>
</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="switching-features">
<h2>Switching features<a class="headerlink" href="#switching-features" title="Permalink to this headline">¶</a></h2>
<p>The driver supports the configuration of L2 forwarding rules in hardware for
port bridging. The forwarding, broadcast and flooding domain between ports can
be restricted through two methods: either at the L2 forwarding level (isolate
one bridge’s ports from another’s) or at the VLAN port membership level
(isolate ports within the same bridge). The final forwarding decision taken by
the hardware is a logical AND of these two sets of rules.</p>
<p>The hardware tags all traffic internally with a port-based VLAN (pvid), or it
decodes the VLAN information from the 802.1Q tag. Advanced VLAN classification
is not possible. Once attributed a VLAN tag, frames are checked against the
port’s membership rules and dropped at ingress if they don’t match any VLAN.
This behavior is available when switch ports are enslaved to a bridge with
<code class="docutils literal notranslate"><span class="pre">vlan_filtering</span> <span class="pre">1</span></code>.</p>
<p>Normally the hardware is not configurable with respect to VLAN awareness, but
by changing what TPID the switch searches 802.1Q tags for, the semantics of a
bridge with <code class="docutils literal notranslate"><span class="pre">vlan_filtering</span> <span class="pre">0</span></code> can be kept (accept all traffic, tagged or
untagged), and therefore this mode is also supported.</p>
<p>Segregating the switch ports in multiple bridges is supported (e.g. 2 + 2), but
all bridges should have the same level of VLAN awareness (either both have
<code class="docutils literal notranslate"><span class="pre">vlan_filtering</span></code> 0, or both 1). Also an inevitable limitation of the fact
that VLAN awareness is global at the switch level is that once a bridge with
<code class="docutils literal notranslate"><span class="pre">vlan_filtering</span></code> enslaves at least one switch port, the other un-bridged
ports are no longer available for standalone traffic termination.</p>
<p>Topology and loop detection through STP is supported.</p>
<p>L2 FDB manipulation (add/delete/dump) is currently possible for the first
generation devices. Aging time of FDB entries, as well as enabling fully static
management (no address learning and no flooding of unknown traffic) is not yet
configurable in the driver.</p>
<p>A special comment about bridging with other netdevices (illustrated with an
example):</p>
<p>A board has eth0, eth1, <a class="reference external" href="mailto:swp0&#37;&#52;&#48;eth1">swp0<span>&#64;</span>eth1</a>, <a class="reference external" href="mailto:swp1&#37;&#52;&#48;eth1">swp1<span>&#64;</span>eth1</a>, <a class="reference external" href="mailto:swp2&#37;&#52;&#48;eth1">swp2<span>&#64;</span>eth1</a>, <a class="reference external" href="mailto:swp3&#37;&#52;&#48;eth1">swp3<span>&#64;</span>eth1</a>.
The switch ports (swp0-3) are under br0.
It is desired that eth0 is turned into another switched port that communicates
with swp0-3.</p>
<p>If br0 has vlan_filtering 0, then eth0 can simply be added to br0 with the
intended results.
If br0 has vlan_filtering 1, then a new br1 interface needs to be created that
enslaves eth0 and eth1 (the DSA master of the switch ports). This is because in
this mode, the switch ports beneath br0 are not capable of regular traffic, and
are only used as a conduit for switchdev operations.</p>
</div>
<div class="section" id="device-tree-bindings-and-board-design">
<h2>Device Tree bindings and board design<a class="headerlink" href="#device-tree-bindings-and-board-design" title="Permalink to this headline">¶</a></h2>
<p>This section references <code class="docutils literal notranslate"><span class="pre">Documentation/devicetree/bindings/net/dsa/sja1105.txt</span></code>
and aims to showcase some potential switch caveats.</p>
<div class="section" id="rmii-phy-role-and-out-of-band-signaling">
<h3>RMII PHY role and out-of-band signaling<a class="headerlink" href="#rmii-phy-role-and-out-of-band-signaling" title="Permalink to this headline">¶</a></h3>
<p>In the RMII spec, the 50 MHz clock signals are either driven by the MAC or by
an external oscillator (but not by the PHY).
But the spec is rather loose and devices go outside it in several ways.
Some PHYs go against the spec and may provide an output pin where they source
the 50 MHz clock themselves, in an attempt to be helpful.
On the other hand, the SJA1105 is only binary configurable - when in the RMII
MAC role it will also attempt to drive the clock signal. To prevent this from
happening it must be put in RMII PHY role.
But doing so has some unintended consequences.
In the RMII spec, the PHY can transmit extra out-of-band signals via RXD[1:0].
These are practically some extra code words (/J/ and /K/) sent prior to the
preamble of each frame. The MAC does not have this out-of-band signaling
mechanism defined by the RMII spec.
So when the SJA1105 port is put in PHY role to avoid having 2 drivers on the
clock signal, inevitably an RMII PHY-to-PHY connection is created. The SJA1105
emulates a PHY interface fully and generates the /J/ and /K/ symbols prior to
frame preambles, which the real PHY is not expected to understand. So the PHY
simply encodes the extra symbols received from the SJA1105-as-PHY onto the
100Base-Tx wire.
On the other side of the wire, some link partners might discard these extra
symbols, while others might choke on them and discard the entire Ethernet
frames that follow along. This looks like packet loss with some link partners
but not with others.
The take-away is that in RMII mode, the SJA1105 must be let to drive the
reference clock if connected to a PHY.</p>
</div>
<div class="section" id="rgmii-fixed-link-and-internal-delays">
<h3>RGMII fixed-link and internal delays<a class="headerlink" href="#rgmii-fixed-link-and-internal-delays" title="Permalink to this headline">¶</a></h3>
<p>As mentioned in the bindings document, the second generation of devices has
tunable delay lines as part of the MAC, which can be used to establish the
correct RGMII timing budget.
When powered up, these can shift the Rx and Tx clocks with a phase difference
between 73.8 and 101.7 degrees.
The catch is that the delay lines need to lock onto a clock signal with a
stable frequency. This means that there must be at least 2 microseconds of
silence between the clock at the old vs at the new frequency. Otherwise the
lock is lost and the delay lines must be reset (powered down and back up).
In RGMII the clock frequency changes with link speed (125 MHz at 1000 Mbps, 25
MHz at 100 Mbps and 2.5 MHz at 10 Mbps), and link speed might change during the
AN process.
In the situation where the switch port is connected through an RGMII fixed-link
to a link partner whose link state life cycle is outside the control of Linux
(such as a different SoC), then the delay lines would remain unlocked (and
inactive) until there is manual intervention (ifdown/ifup on the switch port).
The take-away is that in RGMII mode, the switch’s internal delays are only
reliable if the link partner never changes link speeds, or if it does, it does
so in a way that is coordinated with the switch port (practically, both ends of
the fixed-link are under control of the same Linux system).
As to why would a fixed-link interface ever change link speeds: there are
Ethernet controllers out there which come out of reset in 100 Mbps mode, and
their driver inevitably needs to change the speed and clock frequency if it’s
required to work at gigabit.</p>
</div>
<div class="section" id="mdio-bus-and-phy-management">
<h3>MDIO bus and PHY management<a class="headerlink" href="#mdio-bus-and-phy-management" title="Permalink to this headline">¶</a></h3>
<p>The SJA1105 does not have an MDIO bus and does not perform in-band AN either.
Therefore there is no link state notification coming from the switch device.
A board would need to hook up the PHYs connected to the switch to any other
MDIO bus available to Linux within the system (e.g. to the DSA master’s MDIO
bus). Link state management then works by the driver manually keeping in sync
(over SPI commands) the MAC link speed with the settings negotiated by the PHY.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../devlink-info-versions.html" class="btn btn-neutral float-right" title="Devlink info versions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lan9303.html" class="btn btn-neutral float-left" title="LAN9303 Ethernet switch driver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>